<!DOCTYPE html>
<html lang="zxx">

<head>
    {{>head}}
</head>

<body>

    {{>nav}}


    <!-- product section -->
    <section class="product-section">
        <div class="container">
            <div class="back-link">
                <a href="/category.html"> &lt;&lt; Back to Category</a>
            </div>
            <div class="row">
                <div class="col-lg-6">
                    <div class="product-pic-zoom">
                        <img class="product-big-img" src="{{{shirt.image}}}=s2048" alt="">
                    </div>
                    <div class="product-thumbs" tabindex="1" style="overflow: hidden; outline: none;">
                        <div class="product-thumbs-track">
                            <div class="pt active" data-imgbigurl="{{{shirt.image}}}"><img src="{{{shirt.image}}}" alt=""></div>
                            <div class="pt" data-imgbigurl="{{{shirt.image}}}"><img src="{{{shirt.image}}}" alt=""></div>
                            <div class="pt" data-imgbigurl="{{{shirt.image}}}"><img src="{{{shirt.image}}}" alt=""></div>
                            <div class="pt" data-imgbigurl="{{{shirt.image}}}"><img src="{{{shirt.image}}}" alt=""></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6 product-details">
                    <h2 class="p-title">{{shirt.name}}</h2>

                    <h3 class="p-price mb-1">${{shirt.price}}.99</h3>
                    <div class="social-sharing pt-0">
                        <a href=""><i class="fa fa-google-plus"></i></a>
                        <a href=""><i class="fa fa-pinterest"></i></a>
                        <a href=""><i class="fa fa-facebook"></i></a>
                        <a href=""><i class="fa fa-twitter"></i></a>
                        <a href=""><i class="fa fa-youtube"></i></a>
                    </div>
                    <div id="accordion" class="accordion-area">
                        <div class="panel">
                            <div class="panel-header" id="headingOne">
                                <button class="panel-link active" data-toggle="collapse" data-target="#collapse1" aria-expanded="true" aria-controls="collapse1">Description</button>
                            </div>
                            <div id="collapse1" class="collapse show" aria-labelledby="headingOne" data-parent="#accordion">
                                <div class="panel-body">
                                    <p>{{shirt.description}}</p>
                                </div>
                            </div>
                        </div>
                    </div>



                    <div class="fw-size-choose mt-5">
                        <p>Size</p>
                        <div class="sc-item">
                            <input type="radio" name="sc" id="xs-size">
                            <label for="xs-size">S</label>
                        </div>
                        <div class="sc-item">
                            <input type="radio" name="sc" id="s-size">
                            <label for="s-size">M</label>
                        </div>
                        <div class="sc-item">
                            <input type="radio" name="sc" id="m-size">
                            <label for="m-size">L</label>
                        </div>

                    </div>

                    <div data-prod-id="{{shirt.id}}" id="paypal-button"></div>
                    <div style="visibility:hidden" id="loading-indicator">
                        <img src="/img/loading.gif" />
                    </div>


                </div>
            </div>
        </div>
    </section>
    <!-- product section end -->


    <!-- RELATED PRODUCTS section -->
    <section class="related-product-section">
        <div class="container">
            <div class="section-title">
                <h2>RELATED PRODUCTS</h2>
            </div>
            <div class="product-slider owl-carousel">
                <div class="product-item">
                    <div class="pi-pic">
                        <img src="/img/product/1.jpg" alt="">
                        <div class="pi-links">
                            <a href="#" class="add-card"><i class="flaticon-bag"></i><span>ADD TO CART</span></a>
                            <a href="#" class="wishlist-btn"><i class="flaticon-heart"></i></a>
                        </div>
                    </div>
                    <div class="pi-text">
                        <h6>$35,00</h6>
                        <p>Flamboyant Pink Top </p>
                    </div>
                </div>
                <div class="product-item">
                    <div class="pi-pic">
                        <div class="tag-new">New</div>
                        <img src="/img/product/2.jpg" alt="">
                        <div class="pi-links">
                            <a href="#" class="add-card"><i class="flaticon-bag"></i><span>ADD TO CART</span></a>
                            <a href="#" class="wishlist-btn"><i class="flaticon-heart"></i></a>
                        </div>
                    </div>
                    <div class="pi-text">
                        <h6>$35,00</h6>
                        <p>Black and White Stripes Dress</p>
                    </div>
                </div>
                <div class="product-item">
                    <div class="pi-pic">
                        <img src="/img/product/3.jpg" alt="">
                        <div class="pi-links">
                            <a href="#" class="add-card"><i class="flaticon-bag"></i><span>ADD TO CART</span></a>
                            <a href="#" class="wishlist-btn"><i class="flaticon-heart"></i></a>
                        </div>
                    </div>
                    <div class="pi-text">
                        <h6>$35,00</h6>
                        <p>Flamboyant Pink Top </p>
                    </div>
                </div>
                <div class="product-item">
                    <div class="pi-pic">
                        <img src="/img/product/4.jpg" alt="">
                        <div class="pi-links">
                            <a href="#" class="add-card"><i class="flaticon-bag"></i><span>ADD TO CART</span></a>
                            <a href="#" class="wishlist-btn"><i class="flaticon-heart"></i></a>
                        </div>
                    </div>
                    <div class="pi-text">
                        <h6>$35,00</h6>
                        <p>Flamboyant Pink Top </p>
                    </div>
                </div>
                <div class="product-item">
                    <div class="pi-pic">
                        <img src="/img/product/6.jpg" alt="">
                        <div class="pi-links">
                            <a href="#" class="add-card"><i class="flaticon-bag"></i><span>ADD TO CART</span></a>
                            <a href="#" class="wishlist-btn"><i class="flaticon-heart"></i></a>
                        </div>
                    </div>
                    <div class="pi-text">
                        <h6>$35,00</h6>
                        <p>Flamboyant Pink Top </p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- RELATED PRODUCTS section end -->
    {{>footer}} {{>scripts}}
    <script type="text/javascript" src="https://www.paypal.com/sdk/js?client-id={{pp_client_id}}&disable-funding=credit,card"></script>
    <script>
        (function() {
            console.log('LOAD PAYPAL BUTTON')

            paypal.Buttons({
                style: {
                    size: 'large',
                    layout: 'horizontal',
                    color: 'blue',
                    shape: 'rect',
                    label: 'checkout'
                },
                createOrder: function(data, actions) {
                    $('#paypal-button').css('opacity', '0')
                    $('#loading-indicator').css('visibility', 'inherit')

                    const shirtId = $('#paypal-button').attr('data-prod-id')
                    console.log('SHIRT ID  == ' + shirtId)
                    return fetch('/order/create', {
                            method: 'post',
                            headers: {
                                'Content-type': 'application/json'
                            }

                        })
                        .then(function(res) {
                            return res.json()
                        })
                        .then(function(data) {
                            return data.orderID
                        })
                },

                onCancel: function() {
                    console.log('PURCHASE CANCELED')
                    $('#paypal-button').css('opacity', '1')
                    $('#loading-indicator').css('visibility', 'hidden')
                },
                onApprove: function(data, actions) {
                    return actions.order.capture().then(function(details) {
                            console.log('ORDER PROCESSED:' + JSON.stringify(details))
                            const shirtId = $('#paypal-button').attr('data-prod-id')

                            return fetch('/order/complete', {
                                method: 'post',
                                headers: {
                                    'Content-type': 'application/json'
                                },
                                body: JSON.stringify({
                                    shirtId: shirtId,
                                    paypalOrderId: details.id,
                                    customerEmail: details.payer.email_adress
                                })
                            })
                        })
                        .then(function(res) {
                            return res.json()
                        })
                        .then(function(data) {
                            console.log('ORDER COMPLETED')
                            $('#loading-indicator').html('Thanks ! Your order will arrive soon!')
                        })

                }
            }).render('#paypal-button')
        })
        ()
    </script>

</body>

</html>